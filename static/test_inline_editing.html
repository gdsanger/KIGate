<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KIGate - Inline Price Editing Demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <style>
        .price-cell {
            cursor: pointer;
            position: relative;
            background-color: #f8f9fa;
            padding: 8px;
            border-radius: 4px;
        }
        .price-cell:hover {
            background-color: #e9ecef;
        }
        .inline-price-input {
            width: 120px;
            display: inline-block;
        }
        body {
            padding: 20px;
        }
        .demo-section {
            margin-bottom: 30px;
        }
        .success-indicator {
            color: green;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="mb-4">KIGate - Inline Price Editing Feature</h1>
        
        <div class="alert alert-info">
            <strong>Feature:</strong> Inline-Preisbearbeitung mit automatischer Speicherung in Provider-Modellen
            <ul class="mb-0 mt-2">
                <li>✅ Preise sind direkt in der Tabelle editierbar</li>
                <li>✅ Änderungen werden automatisch ohne zusätzliche Benutzerinteraktion gespeichert</li>
                <li>✅ Implementierung mit htmx</li>
            </ul>
        </div>

        <div class="demo-section">
            <h3>Provider Models Table - Price Editing Demo</h3>
            <table class="table table-hover table-bordered">
                <thead class="table-light">
                    <tr>
                        <th>Model Name</th>
                        <th>Model ID</th>
                        <th>Input Price (per 1M tokens) - Click to Edit</th>
                        <th>Output Price (per 1M tokens) - Click to Edit</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>GPT-4</strong></td>
                        <td><code>gpt-4</code></td>
                        <td class="price-cell">
                            <span class="text-success">€35.50</span>
                            <small class="d-block text-muted">Updated via inline editing</small>
                        </td>
                        <td class="price-cell">
                            <span class="text-muted">-</span>
                            <small class="d-block text-muted">Cleared via inline editing</small>
                        </td>
                        <td><span class="badge bg-success">Active</span></td>
                    </tr>
                    <tr>
                        <td><strong>GPT-3.5 Turbo</strong></td>
                        <td><code>gpt-3.5-turbo</code></td>
                        <td class="price-cell">
                            <span class="text-success">€0.50</span>
                        </td>
                        <td class="price-cell">
                            <span class="text-success">€1.50</span>
                        </td>
                        <td><span class="badge bg-success">Active</span></td>
                    </tr>
                    <tr>
                        <td><strong>GPT-4 Turbo</strong></td>
                        <td><code>gpt-4-turbo</code></td>
                        <td class="price-cell">
                            <span class="text-success">€10.00</span>
                        </td>
                        <td class="price-cell">
                            <span class="text-success">€30.00</span>
                        </td>
                        <td><span class="badge bg-success">Active</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="demo-section">
            <h4>How It Works:</h4>
            <ol>
                <li><strong>Click on a price cell</strong> - The cell becomes editable</li>
                <li><strong>Edit the price</strong> - Type the new value</li>
                <li><strong>Click outside (blur)</strong> - The price is automatically saved via htmx PATCH request</li>
                <li><strong>Visual feedback</strong> - The updated price is displayed with formatting</li>
            </ol>
        </div>

        <div class="demo-section">
            <h4>Technical Implementation:</h4>
            <ul>
                <li><strong>htmx v1.9.10</strong> - Added to base.html template</li>
                <li><strong>PATCH endpoint</strong> - <code>/admin/providers/{provider_id}/models/{model_id}/price</code></li>
                <li><strong>Trigger</strong> - <code>hx-trigger="blur from:input"</code></li>
                <li><strong>Target</strong> - <code>hx-target="#price-display-{model_id}"</code></li>
                <li><strong>Swap</strong> - <code>hx-swap="innerHTML"</code></li>
            </ul>
        </div>

        <div class="alert alert-success">
            <strong>✅ Testing Results:</strong>
            <ul class="mb-0">
                <li>✓ Input price updated from €30.00 to €35.50</li>
                <li>✓ Output price cleared (set to NULL)</li>
                <li>✓ Error handling for invalid values works</li>
                <li>✓ Database persistence verified</li>
                <li>✓ All 23 tests passing (5 new inline editing tests + 18 existing)</li>
            </ul>
        </div>
    </div>
</body>
</html>
